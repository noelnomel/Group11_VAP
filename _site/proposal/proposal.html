<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Wan Kee, Vanessa, Noel">
<meta name="dcterms.date" content="2024-02-03">

<title>The Heat is On! - Project Proposal</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">The Heat is On!</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../proposal/proposal.html" rel="" target="" aria-current="page">
 <span class="menu-text">Proposal</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Station/station.html" rel="" target="">
 <span class="menu-text">Station</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-exploratory-data-analysis" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Exploratory Data Analysis</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-exploratory-data-analysis">    
        <li>
    <a class="dropdown-item" href="../EDA/Data_Preparation.html" rel="" target="">
 <span class="dropdown-text">Data Preparation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../EDA/EDA_Noel.html" rel="" target="">
 <span class="dropdown-text">EDA_Noel</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../EDA/EDA_Vanessa.html" rel="" target="">
 <span class="dropdown-text">EDA_Vanessa</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../EDA/EDA_Wankee.html" rel="" target="">
 <span class="dropdown-text">EDA_Wankee</span></a>
  </li>  
    </ul>
  </li>
  <li class="dropdown-header">
 <span class="menu-text">Rainfall</span></li>
  <li class="dropdown-header">
 <span class="menu-text">Temperature</span></li>
  <li class="dropdown-header">
 <span class="menu-text">Relative Humidity</span></li>
  <li class="dropdown-header">
 <span class="menu-text">Wind</span></li>
  <li class="nav-item">
    <a class="nav-link" href="https://chockwankee.shinyapps.io/Group11_VAP_ShinyApp/" rel="" target="">
 <span class="menu-text">Shiny App</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">1. Introduction</a></li>
  <li><a href="#project-objectives" id="toc-project-objectives" class="nav-link" data-scroll-target="#project-objectives">2. Project Objectives</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">3. Data</a></li>
  <li><a href="#methodology-and-analysis" id="toc-methodology-and-analysis" class="nav-link" data-scroll-target="#methodology-and-analysis">4. Methodology and Analysis</a>
  <ul class="collapse">
  <li><a href="#exploratory-data-analysis-and-visualizations" id="toc-exploratory-data-analysis-and-visualizations" class="nav-link" data-scroll-target="#exploratory-data-analysis-and-visualizations">4.1. Exploratory Data Analysis and Visualizations</a></li>
  <li><a href="#predictive-model" id="toc-predictive-model" class="nav-link" data-scroll-target="#predictive-model">4.2. Predictive Model</a></li>
  </ul></li>
  <li><a href="#scope-of-work" id="toc-scope-of-work" class="nav-link" data-scroll-target="#scope-of-work">5. Scope of Work</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">6. Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Project Proposal</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Wan Kee, Vanessa, Noel </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 3, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">February 24, 2024</p>
    </div>
  </div>
    
  </div>
  

</header>

<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://www.todayonline.com/singapore/explainer-what-causing-heatwaves-around-world-and-will-singapore-be-affected-1947631"><img src="https://onecms-res.cloudinary.com/image/upload/s--DSRC9SfJ--/f_auto,q_auto/c_fill,g_auto,h_622,w_830/v1/mediacorp/tdy/image/2022/07/19/20220719_reuters_heatwave.jpg?itok=pvMvUHUm" class="img-fluid figure-img"></a></p>
<figcaption class="figure-caption">Source: Today Online</figcaption>
</figure>
</div>
<section id="introduction" class="level1">
<h1>1. Introduction</h1>
<p>In our efforts to combat the adverse effects of climate change, particularly on island nations like Singapore, Prime Minister Lee Hsien Loong has committed to concerted international efforts to mitigate this global challenge. At the United Nations Climate Ambition Summit on 12 December 2020, he emphasized, “Climate change is an existential threat for all of us, but especially for a small island state like Singapore. … Singapore will do our part, together with other countries, to address climate change.”</p>
<p>Scientific evidence supports the urgency of this commitment. A joint study by the Meteorological Service Singapore’s (MSS) Centre for Climate Research Singapore (CCRS) and the UK Met Office contextualised the findings of the Intergovernmental Panel on Climate Change’s Sixth Assessment Report <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. It revealed that mean temperatures rose at an average rate of 0.25°C per decade and that daily mean temperatures are projected to increase between 1.4°C to 4.6°C by the end of 21st Century. <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>.</p>
<p>The implications for sea-level rise are profound., From 1975 to 2009, the sea level in the Straits of Singapore rose at the rate of 1.2 mm to 1.7 mm per year and is projected to increase by about 1 meter by 2100 <a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. The repercussions are dire for Singapore as a low-lying state; its vulnerability to the effects of climate change cannot be undermined <a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>.</p>
<p>In response, Singapore is prepared to invest significantly, at least S$100 billion over the next 100 years in engineering solutions to protect Singapore’s coastlines from rising sea levels. This proactive stance reflects a deep understanding of the looming threats and a resolve to protect the nation’s future.</p>
</section>
<section id="project-objectives" class="level1">
<h1>2. Project Objectives</h1>
<p>The motivation of the project is to maximise the potential of publicly available data through the exploration of the impact of climate change on Singapore and how it threatens Singapore’s existence. This is of grave concern to all Singaporeans with a stake in the country. The main objectives of the project can be broken down into the following areas:</p>
<ol type="1">
<li><p>Create clear and easy-to-understand visualisations of past trends to increase the public’s awareness</p></li>
<li><p>Model and predict future trends to assist the government’s efforts using historical data.</p></li>
</ol>
<p>To meet the the objectives of increasing public awareness and assisting the government’s efforts on the impact of climate change, a public webpage equipped with data visualisation and interactive applications will be developed for members of the public to gain clear insights into Singapore’s weather trends. The overall outcomes of the project are:</p>
<ol type="1">
<li><p>Educate through interactive data visualisations where the webpage will include a dashboard featuring a variety of visualisations that depict pas climate data and trends. Interactive parameters allow the users to select different time periods or types of data to visualize.</p></li>
<li><p>Engage users with interactive predictive models through sliders and input fields to simulate different environmental variables and visualize the outcomes of different actions taken today on future climate conditions.</p></li>
<li><p>Facilitate knowledge sharing and community involvement by implementing a forum or discussion board where the public users can discuss climate issues and propose solutions.</p></li>
</ol>
</section>
<section id="data" class="level1">
<h1>3. Data</h1>
<p>The dataset used in this study is prepared and maintained by the Meteorological Service Singapore (MSS). The MSS collects rainfall, temperature, and wind speed data from available weather stations since 1980. However, a quick scan of the <a href="http://www.weather.gov.sg/climate-historical-daily/">MSS Historical Daily Records site</a> shows that not all weather stations recorded all data types from 1980. This is because manual observations were replaced with automated instruments from 2009<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>.</p>
<p>This means that there are some gaps in the data set:</p>
<ul>
<li><p>37 out of the 63 weather stations only recorded rainfall data starting between 2009 and 2011.</p></li>
<li><p>41 out of the 63 weather stations do not record temperature data, even up to now.</p></li>
<li><p>Out of the 22 weather stations that record temperature data, only three stations recorded data from the 1980s (from 1982 in Changi and from 1986 in Tengah and Paya Lebar).</p></li>
</ul>
<p>For this project, we will analyse the historical temperature and rainfall data collected by MSS based on the 22 weather stations (Table 1).</p>
<p>The selected stations with complete datasets from 1980 onwards provide a long-term perspective on climate trends, which is crucial for accurate modelling and prediction. Automated instruments from 2009 enhance data reliability and allow for continuous monitoring without manual intervention gaps.</p>
<p><img src="..\images/Table1.png" class="img-fluid"></p>
<p>Table 1 presents the overview of the meteorological data recording periods across 22 selected weather stations in Singapore.</p>
<p>The selected stations are well-distributed across Singapore’s geography, covering coastal areas, inland locations and urban centers (Figure 1). This distribution ensures that the stations capture various microclimates within the country.</p>
<p><img src="..\images/Figure1.png" class="img-fluid"></p>
<p>Figure 1 juxtaposes two maps of Singapore to contrast the distribution of weather stations across the island displaying 63 stations (left) and 22 selected stations (right).</p>
</section>
<section id="methodology-and-analysis" class="level1">
<h1>4. Methodology and Analysis</h1>
<section id="exploratory-data-analysis-and-visualizations" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis-and-visualizations">4.1. Exploratory Data Analysis and Visualizations</h2>
<p>Firstly, our exploratory data analysis will uncover trends in Singapore’s historical climate data through a range of visualizations to convey our finding effectively:</p>
<ul>
<li><p>Time series analysis utilizes time-dependent decomposition to discern the variations, trends and anomalies in the climate data across the periods</p></li>
<li><p>Comparative analysis using box plots and violin plots to highlight the differences in climate data across periods or locations • Heatmap to plot changes in climate data by periods</p></li>
<li><p>Distribution analysis through ridgeline plots to show the distribution of climate data by specific periods or locations</p></li>
<li><p>Correlation matrix between climate data to investigate the inter dependencies between the climate data</p></li>
<li><p>Interactive maps to show geographical impacts of climate change, such as potential flooding areas and urban heat issues.</p></li>
</ul>
<p>The visualizations will be created using R packages;<code>ggplot2</code> for foundational graphics, extensions such as <code>ggridges</code> for ridgeline plots, <code>ggthemes</code> and <code>patchwork</code> for styling and layouts. Interactive graphics will be incorporated using <code>ggiraph</code> and <code>plotly</code> and the animations produced via <code>gganimate</code>.</p>
<p>Interactivity can be included in the visualizations, such as coordinated multiple views to show temperature and rainfall data side-by-side. Animations can be used to showcase changes in temperature and rainfall over the years.</p>
</section>
<section id="predictive-model" class="level2">
<h2 class="anchored" data-anchor-id="predictive-model">4.2. Predictive Model</h2>
<p>We aim to forecast future climate trends by exploring a suite of time series forecasting models:</p>
<ol type="1">
<li><p>Time series forecasting is the process of using historical data to predict future values of a variable that changes over time. It is a common and useful technique for weather prediction. &nbsp;There are many types of models for time series forecasting, such as exponential smoothing, ARIMA, SARIMA, VAR and neural networks.</p></li>
<li><p>Machine learning approaches, such as Random Forest and Gradient Boosting Machines, for non-linear trend capturing.</p></li>
</ol>
<p>We will compare and evaluate different models based on their predictive performance in terms of accuracy, precision and recall using evaluation metrics such as cross-validation, AIC and BIC, and forecasting accuracy measures using RMSE. The interpretability of models will also be a key consideration to ensure that the findings are understandable to the public (Figure 2).</p>
<p><img src="images/Prototype.jpg" class="img-fluid">Figure 2 is a prototype of RShiny application.</p>
</section>
</section>
<section id="scope-of-work" class="level1">
<h1>5. Scope of Work</h1>
<p>The project will begin with an initial planning and research phase where a comprehensive literature review will be conducted to understand existing climate models and their applicability to Singapore.</p>
<p>In the data collection and preprocessing stage, historical climate data will be gathered from reliable sources. This data will undergo rigorous cleaning and preprocessing to prepare it for analysis. Exploratory data analysis will then be carried out to detect patterns, trends, and outliers within the data, with preliminary visualizations developed to summarize these findings.</p>
<p>The core of the project will involve developing and validating predictive models using various statistical and machine learning techniques. These models will be evaluated and refined based on their performance metrics to ensure accuracy and reliability. The project will culminate in a final analysis based on the predictive models to inform the public. Upon completion, all project deliverables will be finalized, and a project closure phase will ensure all data and documentation are archived, and training is provided for the use of the developed tools.</p>
<p>Finally, the project will outline a strategy for ongoing monitoring of climate data and regular updates to the models. This will also identify opportunities for further research to enhance predictive capabilities and the overall user experience of the developed tools.</p>
<p><img src="..\images/Figure3.png" class="img-fluid"></p>
<p>Figure 3 is the time management Gantt chart of this project.</p>
</section>
<section id="conclusion" class="level1">
<h1>6. Conclusion</h1>
<p>This project aims to create an interactive platform on an RShiny app to visualize historical climate trends and forecast future patterns of Singapore’s temperature and rainfall. This application serves &nbsp;as an dynamic educational tool to help raise awareness on the urgency of climate change and inspire individuals and organisations to make incremental lifestyle changes and adopt sustainable practices that align with the objectives &nbsp;Singapore Green Plan 2030. By facilitating a deeper understanding of environmental changes through accessible data visualizations and predictive modelling, the project seeks to foster a proactive approach to environmental stewardship within the community.</p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>https://www.ipcc.ch/report/ar6/syr/downloads/report/IPCC_AR6_SYR_SPM.pdf<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>https://www.nccs.gov.sg/singapores-climate-action/impact-of-climate-change-in-singapore/<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>https://www.mse.gov.sg/policies/climate-change#:~:text=Understanding%20Climate%20Change&amp;text=A%20warmer%20climate%20leads%20to,more%20frequent%20extreme%20weather%20events.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>https://www.todayonline.com/singapore/explainer-why-climate-change-should-matter-singaporeans-and-what-government-doing-about-it<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>http://www.weather.gov.sg/wp-content/uploads/2022/06/Station_Records.pdf<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>