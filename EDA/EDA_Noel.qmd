---
title: "EDA_Noel"
author: "Noel"
format: html
execute: 
  echo: true # all code chunks will appear
  eval: true # all code chunks will run live
  warning: false # do not display warning message
  freeze: true # do not render if no changes made
  message: false
---

```{r}
pacman::p_load(tidyverse, ggdist, ggridges, heatmaply, ggiraph)

```

```{r}
temperature <- readRDS("data/temperature.rds")
```

```{r}
temp_avg <- temperature %>%
  group_by(Station, Year) %>%
  summarise(Avg_Mean = mean(MeanTemp),
            Avg_Max = mean(MaxTemp),
            Avg_Min = mean(MinTemp))
```


# time series - average of mean temperatures

```{r}
ggplot(data = temp_avg,
       aes(x = Year,
           y = Avg_Mean,
           group = Station,
           color = Station)) +
  geom_line(linewidth = 1.2) +
  theme_classic() +
  ylab("Daily Mean Temperature (°C)") +
  xlab("Day of Month") +
  ggtitle("Daily Mean Temperature Recorded At Tengah Weather Station",
          subtitle = "September 1986, 1993, 2003, 2013, 2023") +
  theme(plot.title = element_text(size = 10),
        plot.subtitle = element_text(size = 8)) 
```

```{r}
temp_avg$mean_tooltip <- c(paste0(
  "Year: ", temp_avg$Year,
  "\n Station: ", temp_avg$Station,
  "\n Mean Temp: ", temp_avg$Avg_Mean, "°C"))

line <- ggplot(data = temp_avg,
               aes(x = Year,
                   y = Avg_Mean,
                   group = Station,
                   color = Station,
                   data_id = Station)) +
  geom_line_interactive(size = 1.2,
                        alpha = 0.4) +
  geom_point_interactive(aes(tooltip = temp_avg$mean_tooltip),
                         fill = "white",
                         size = 1,
                         stroke = 1,
                         shape = 21) +
  theme_classic() +
  ylab("Annual Mean Temperature (°C)") +
  xlab("Year") +
  ggtitle("Annual Average of Mean Temperatures") +
  theme(plot.title = element_text(size = 10),
        plot.subtitle = element_text(size = 8)) 

girafe(ggobj = line, 
       width_svg = 8,
       height_svg = 6 * 0.618,
       options = list(
         opts_hover(css = "stroke-width: 2.5; opacity: 1;"),
         opts_hover_inv(css = "stroke-width: 1;opacity:0.6;")))

```

# time series - average of max temperatures

```{r}
temp_avg$max_tooltip <- c(paste0(
  "Year: ", temp_avg$Year,
  "\n Station: ", temp_avg$Station,
  "\n Max Temp: ", temp_avg$Avg_Max, "°C"))

line <- ggplot(data = temp_avg,
               aes(x = Year,
                   y = Avg_Max,
                   group = Station,
                   color = Station,
                   data_id = Station)) +
  geom_line_interactive(size = 1.2,
                        alpha = 0.4) +
  geom_point_interactive(aes(tooltip = temp_avg$max_tooltip),
                         fill = "white",
                         size = 1,
                         stroke = 1,
                         shape = 21) +
  theme_classic() +
  ylab("Annual Max Temperature (°C)") +
  xlab("Year") +
  ggtitle("Annual Average of Max Temperatures") +
  theme(plot.title = element_text(size = 10),
        plot.subtitle = element_text(size = 8)) 

girafe(ggobj = line, 
       width_svg = 8,
       height_svg = 6 * 0.618,
       options = list(
         opts_hover(css = "stroke-width: 2.5; opacity: 1;"),
         opts_hover_inv(css = "stroke-width: 1;opacity:0.6;")))

```

# time series - average of min temperatures

```{r}
temp_avg$min_tooltip <- c(paste0(
  "Year: ", temp_avg$Year,
  "\n Station: ", temp_avg$Station,
  "\n Min Temp: ", temp_avg$Avg_Min, "°C"))

line <- ggplot(data = temp_avg,
               aes(x = Year,
                   y = Avg_Min,
                   group = Station,
                   color = Station,
                   data_id = Station)) +
  geom_line_interactive(size = 1.2,
                        alpha = 0.4) +
  geom_point_interactive(aes(tooltip = temp_avg$min_tooltip),
                         fill = "white",
                         size = 1,
                         stroke = 1,
                         shape = 21) +
  theme_classic() +
  ylab("Annual Min Temperature (°C)") +
  xlab("Year") +
  ggtitle("Annual Average of Min Temperatures") +
  theme(plot.title = element_text(size = 10),
        plot.subtitle = element_text(size = 8)) 

girafe(ggobj = line, 
       width_svg = 8,
       height_svg = 6 * 0.618,
       options = list(
         opts_hover(css = "stroke-width: 2.5; opacity: 1;"),
         opts_hover_inv(css = "stroke-width: 1;opacity:0.6;")))

```

