{
  "hash": "844df51017f5d49a6e3eb961aa1da3f4",
  "result": {
    "markdown": "---\ntitle: \"Prototype - Confirmatory Data Analysis\"\nformat: html\nexecute: \n  echo: true # all code chunks will appear\n  eval: true # all code chunks will run live\n  warning: false # do not display warning message\n  freeze: true\neditor: visual\n---\n\n\n# 1 Load Packages\n\nWe will load the following R packages for this exercise:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse, ggstatsplot, ExPanDaR)\n```\n:::\n\n\n# 2 Load Data\n\nThe data used in this exercise are obtained from the [Meteorological Service Singapore Website](https://www.weather.gov.sg/climate-historical-daily/). To better align the outputs of the individual assignment to the project, my team has standardised the data cleaning steps on our [project website](https://merrycheesecake-isss608.netlify.app/eda/data_preparation). As the cleaned data sets were saved as RDS files, we will load them using `read_rds()` for this exercise.\n\n### 2.1. Load temperature data\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntemp_monthly <- read_rds(\"data/temp_monthly.rds\")\nglimpse(temp_monthly)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 3,715\nColumns: 9\n$ Station       <chr> \"Admiralty\", \"Admiralty\", \"Admiralty\", \"Admiralty\", \"Adm…\n$ Region        <chr> \"North\", \"North\", \"North\", \"North\", \"North\", \"North\", \"N…\n$ Year          <dbl> 2009, 2009, 2009, 2009, 2009, 2009, 2009, 2009, 2009, 20…\n$ Month         <ord> Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, D…\n$ Avg_Mean_Temp <dbl> 26.3, 26.8, 26.9, 28.1, 28.5, 28.9, 28.1, 28.1, 28.3, 28…\n$ Avg_Max_Temp  <dbl> 31.9, 33.4, 34.5, 35.1, 34.7, 34.7, 33.7, 33.6, 34.3, 34…\n$ Avg_Min_Temp  <dbl> 23.3, 23.0, 22.2, 23.7, 21.8, 23.7, 22.5, 22.7, 23.1, 22…\n$ Max_Temp      <dbl> 31.9, 33.4, 34.5, 35.1, 34.7, 34.7, 33.7, 33.6, 34.3, 34…\n$ Min_Temp      <dbl> 23.3, 23.0, 22.2, 23.7, 21.8, 23.7, 22.5, 22.7, 23.1, 22…\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntemp_annual <- read_rds(\"data/temp_annual.rds\")\nglimpse(temp_annual)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 323\nColumns: 8\n$ Station       <chr> \"Admiralty\", \"Admiralty\", \"Admiralty\", \"Admiralty\", \"Adm…\n$ Region        <chr> \"North\", \"North\", \"North\", \"North\", \"North\", \"North\", \"N…\n$ Year          <dbl> 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 20…\n$ Avg_Mean_Temp <dbl> 27.6, 27.8, 27.3, 27.4, 27.5, 27.6, 27.9, 28.1, 27.7, 27…\n$ Avg_Max_Temp  <dbl> 34.0, 34.7, 33.9, 33.9, 34.3, 34.0, 34.1, 34.4, 34.4, 34…\n$ Avg_Min_Temp  <dbl> 22.9, 22.4, 22.3, 22.5, 22.6, 22.8, 23.0, 22.9, 22.9, 22…\n$ Max_Temp      <dbl> 35.1, 36.6, 35.5, 34.7, 36.2, 35.8, 35.1, 36.3, 35.3, 35…\n$ Min_Temp      <dbl> 21.8, 21.3, 21.2, 21.6, 21.7, 21.8, 22.2, 21.9, 22.1, 21…\n```\n:::\n:::\n\n\n### 2.2. Load rainfall data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrf_monthly <- read_rds(\"data/rf_monthly.rds\")\nglimpse(rf_monthly)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 5,547\nColumns: 14\n$ Station         <chr> \"Admiralty\", \"Admiralty\", \"Admiralty\", \"Admiralty\", \"A…\n$ Region          <chr> \"North\", \"North\", \"North\", \"North\", \"North\", \"North\", …\n$ Year            <dbl> 2009, 2009, 2009, 2009, 2009, 2009, 2009, 2009, 2009, …\n$ Month           <ord> Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov,…\n$ Total_Rf        <dbl> 0.8, 148.0, 348.0, 148.8, 205.6, 92.0, 103.0, 90.2, 67…\n$ Total_Rf_30     <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ Total_Rf_60     <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ Total_Rf_120    <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ Avg_Total_Rf    <dbl> 0.8, 148.0, 348.0, 148.8, 205.6, 92.0, 103.0, 90.2, 67…\n$ Avg_Total_Rf30  <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ Avg_Total_Rf60  <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ Avg_Total_Rf120 <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ Min_Total_Rf    <dbl> 0.8, 148.0, 348.0, 148.8, 205.6, 92.0, 103.0, 90.2, 67…\n$ Max_Total_Rf    <dbl> 0.8, 148.0, 348.0, 148.8, 205.6, 92.0, 103.0, 90.2, 67…\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nrf_annual <- read_rds(\"data/rf_annual.rds\")\nglimpse(rf_annual)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 469\nColumns: 13\n$ Station         <chr> \"Admiralty\", \"Admiralty\", \"Admiralty\", \"Admiralty\", \"A…\n$ Region          <chr> \"North\", \"North\", \"North\", \"North\", \"North\", \"North\", …\n$ Year            <dbl> 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, …\n$ Total_Rf        <dbl> 1736.6, 2980.8, 2871.8, 2916.8, 2559.8, 1809.3, 2046.8…\n$ Total_Rf_30     <dbl> 0.0, 0.0, 0.0, 0.0, 0.0, 1184.8, 1341.4, 1250.4, 1222.…\n$ Total_Rf_60     <dbl> 0.0, 0.0, 0.0, 0.0, 0.0, 1434.8, 1636.2, 1546.2, 1471.…\n$ Total_Rf_120    <dbl> 0.0, 0.0, 0.0, 0.0, 0.0, 1556.3, 1852.0, 1743.2, 1645.…\n$ Avg_Total_Rf    <dbl> 144.7, 248.4, 239.3, 243.1, 213.3, 164.5, 170.6, 164.0…\n$ Avg_Total_Rf30  <dbl> 0.0, 0.0, 0.0, 0.0, 0.0, 107.7, 111.8, 104.2, 101.8, 1…\n$ Avg_Total_Rf60  <dbl> 0.0, 0.0, 0.0, 0.0, 0.0, 130.4, 136.3, 128.8, 122.6, 1…\n$ Avg_Total_Rf120 <dbl> 0.0, 0.0, 0.0, 0.0, 0.0, 141.5, 154.3, 145.3, 137.1, 1…\n$ Min_Total_Rf    <dbl> 0.8, 84.4, 63.8, 105.4, 75.0, 15.8, 62.0, 54.8, 0.0, 7…\n$ Max_Total_Rf    <dbl> 348.0, 472.6, 455.6, 455.8, 319.0, 301.0, 351.2, 256.6…\n```\n:::\n:::\n\n\n# 3. Confirmatory Data Analysis (CDA)\n\nFor the purpose of the project, CDA will be conducted to compare the following:\n\n-   Is there a significant difference in the annual temperature recorded at the selected weather stations or regions?\n\n-   Is there a significant difference in the monthly temperature recorded at the selected weather stations or regions?\n\n-   Is there a significant difference in the annual total rainfall recorded at the selected weather stations or regions?\n\n-   Is there a significant difference in the monthly total rainfall recorded at the selected weather stations or regions?\n\n# 4. Creating Static Plots\n\nFirst, we begin by creating a static plots to check the feasibility of each plot. Before we do so, we will create an additional table to hold the aggregated values to be used in the plots.\n\n## 4.1. Comparing Temperature Without Functions\n\nFirst, we create a static plot without functions to visualise the output.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggbetweenstats(data = temp_annual,\n               x = Station, \n               y = Avg_Max_Temp,\n               plot.type = \"boxviolin\",\n               type = \"nonparametric\",\n               pairwise.display = \"non-significant\",\n               messages = FALSE)\n```\n\n::: {.cell-output-display}\n![](CDA_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggbetweenstats(data = temp_monthly,\n               x = Region, \n               y = Avg_Max_Temp,\n               plot.type = \"boxviolin\",\n               type = \"nonparametric\",\n               pairwise.display = \"non-significant\",\n               messages = FALSE)\n```\n\n::: {.cell-output-display}\n![](CDA_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n## 4.3. Comparing Rainfall Without Functions\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggbetweenstats(data = rf_annual,\n               x = Station, \n               y = Avg_Total_Rf,\n               plot.type = \"boxviolin\",\n               type = \"nonparametric\",\n               pairwise.display = \"non-significant\",\n               messages = FALSE)\n```\n\n::: {.cell-output-display}\n![](CDA_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggbetweenstats(data = rf_monthly,\n               x = Region, \n               y = Min_Total_Rf,\n               plot.type = \"boxviolin\",\n               type = \"nonparametric\",\n               pairwise.display = \"non-significant\",\n               messages = FALSE)\n```\n\n::: {.cell-output-display}\n![](CDA_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n::: {.callout-note title=\"UI Considerations\"}\nWith the Shiny app in mind, some parameters that can allow user-input in this plot include:\n\n-   `plot.type`: accepts `boxviolin`, `box`, `violin`\n\n-   `type`: accepts `nonparametric`, `parametric`, `robust`, `bayes`\n\n-   `pairwise.display` = accepts `significant`, `non-significant`, `everything`, `all`\n:::\n\n# 5. Compare Annual Temperature\n\n## 5.1. Create Function - Annual Temperature by Station\n\nFrom the plots above, it is difficult to compare the chosen metric of all stations at once. Due to the number of stations available, each plot becomes very small and much of the details are lost. We will now attempt to create a function to display only the top3 stations by average annual temperature recorded.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntemp_annual_sorted <-  temp_annual %>%\n  arrange(desc(Avg_Mean_Temp))\n\ntop3 <- temp_annual_sorted$Station[1:3]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nAnnual_Top3_Temp_Station <- function(metric = \"Avg_Mean_Temp\", \n                                selected_station,\n                                p_type = \"boxviolin\",\n                                t_type = \"nonparametric\",\n                                pair_disp = \"non-significant\",\n                                pair.comp = T,\n                                conf = 0.95,\n                                nooutliers = T){\n  \n  metric_label = case_when(metric == \"Avg_Mean_Temp\" ~ \"Average Mean Temperature\",\n                           metric == \"Avg_Max_Temp\" ~ \"Average of Max Temperature\",\n                           metric == \"Avg_Min_Temp\" ~ \"Average of Minimum Temperature\",\n                           metric == \"Max_Temp\" ~ \"Maximum Temperature\",\n                           metric == \"Min_Temp\" ~ \"Minimum Temperature\",\n                           TRUE ~ metric)\n  \n  test_label = case_when(t_type == \"parametric\" ~ \"Mean (Parametric)\",\n                         t_type == \"nonparametric\" ~ \"Median (Non-Parametric)\",\n                         t_type == \"robust\" ~ \"Mean (Robust t-test)\",\n                         t_type == \"bayes\" ~ \"Mean (Bayesian)\",)\n  \n  temp_annual_anova <- temp_annual %>%\n    filter(Station %in% selected_station) %>%\n    mutate(Station = fct_reorder(Station, !!sym(metric), .desc = TRUE))\n  \n  if(nooutliers == T){\n  temp_annual_anova <- temp_annual_anova %>%\n      treat_outliers() \n  }\n  \n  temp_annual_anova %>%\n    ggbetweenstats(x = Station,\n                   y = !!sym(metric),\n                   plot.type = p_type,\n                   type = t_type,\n                   pairwise.comparisons = T,\n                   pairwise.display = pair_disp,\n                   mean.ci = T, \n                   p.adjust.method = \"fdr\",\n                   conf.level = conf,\n                   xlab = \"Station\", ylab = metric_label,)\n}\n```\n:::\n\n\n::: panel-tabset\n#### Test 1\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAnnual_Top3_Temp_Station(metric = \"Avg_Mean_Temp\", \n                         selected_station = top3,\n                         p_type = \"boxviolin\",\n                         t_type = \"nonparametric\",\n                         pair_disp = \"non-significant\",\n                         pair.comp = T,\n                         conf = 0.95,\n                         nooutliers = T)\n```\n\n::: {.cell-output-display}\n![](CDA_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n#### Test 2\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAnnual_Top3_Temp_Station(metric = \"Max_Temp\", \n                         selected_station = top3,\n                         p_type = \"box\",\n                         t_type = \"nonparametric\",\n                         pair_disp = \"non-significant\",\n                         pair.comp = T,\n                         conf = 0.95,\n                         nooutliers = T)\n```\n\n::: {.cell-output-display}\n![](CDA_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n#### Test 3\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAnnual_Top3_Temp_Station(metric = \"Avg_Min_Temp\", \n                         selected_station = top3,\n                         p_type = \"violin\",\n                         t_type = \"nonparametric\",\n                         pair_disp = \"non-significant\",\n                         pair.comp = T,\n                         conf = 0.99,\n                         nooutliers = T)\n```\n\n::: {.cell-output-display}\n![](CDA_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n:::\n\n## 5.2. Create Function - Annual temperature by Region\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAnnual_Temp_Region <- function(metric = \"Avg_Mean_Temp\", \n                               p_type = \"boxviolin\",\n                               t_type = \"nonparametric\",\n                               pair_disp = \"non-significant\",\n                               pair.comp = T,\n                               conf = 0.95,\n                               nooutliers = T){\n  \n  metric_label = case_when(metric == \"Avg_Mean_Temp\" ~ \"Average Mean Temperature\",\n                           metric == \"Avg_Max_Temp\" ~ \"Average of Max Temperature\",\n                           metric == \"Avg_Min_Temp\" ~ \"Average of Minimum Temperature\",\n                           metric == \"Max_Temp\" ~ \"Maximum Temperature\",\n                           metric == \"Min_Temp\" ~ \"Minimum Temperature\",\n                           TRUE ~ metric)\n  \n  test_label = case_when(t_type == \"parametric\" ~ \"Mean (Parametric)\",\n                         t_type == \"nonparametric\" ~ \"Median (Non-Parametric)\",\n                         t_type == \"robust\" ~ \"Mean (Robust t-test)\",\n                         t_type == \"bayes\" ~ \"Mean (Bayesian)\",)\n  \n  if(nooutliers == T){\n  temp_annual <- temp_annual %>%\n      treat_outliers() \n  }\n  \n  temp_annual %>%\n    ggbetweenstats(x = Region,\n                   y = !!sym(metric),\n                   plot.type = p_type,\n                   type = t_type,\n                   pairwise.comparisons = T,\n                   pairwise.display = pair_disp,\n                   mean.ci = T, \n                   p.adjust.method = \"fdr\",\n                   conf.level = conf,\n                   xlab = \"Region\", ylab = metric_label,)\n}\n```\n:::\n\n\n::: panel-tabset\n#### Test 1\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAnnual_Temp_Region(metric = \"Avg_Mean_Temp\", \n                   p_type = \"boxviolin\",\n                   t_type = \"nonparametric\",\n                   pair_disp = \"non-significant\",\n                   pair.comp = T,\n                   conf = 0.95,\n                   nooutliers = T)\n```\n\n::: {.cell-output-display}\n![](CDA_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n#### Test 2\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAnnual_Temp_Region(metric = \"Max_Temp\",\n                   p_type = \"box\",\n                   t_type = \"nonparametric\",\n                   pair_disp = \"non-significant\",\n                   pair.comp = T,\n                   conf = 0.95,\n                   nooutliers = T)\n```\n\n::: {.cell-output-display}\n![](CDA_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n#### Test 3\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAnnual_Temp_Region(metric = \"Avg_Min_Temp\", \n                   p_type = \"violin\",\n                   t_type = \"nonparametric\",\n                   pair_disp = \"non-significant\",\n                   pair.comp = T,\n                   conf = 0.99,\n                   nooutliers = T)\n```\n\n::: {.cell-output-display}\n![](CDA_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n:::\n\n# 6. Compare Monthly Temperature\n\n## 6.1. Create Function - Monthly temperature by Station\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntemp_monthly_sorted <-  temp_monthly %>%\n  arrange(desc(Avg_Mean_Temp))\n\ntop3 <- temp_monthly_sorted$Station[1:3]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nMonthly_Top3_Temp_Station <- function(metric = \"Avg_Mean_Temp\", \n                                      selected_station,\n                                      p_type = \"boxviolin\",\n                                      t_type = \"nonparametric\",\n                                      pair_disp = \"non-significant\",\n                                      pair.comp = T,\n                                      conf = 0.95,\n                                      nooutliers = T){\n  \n  metric_label = case_when(metric == \"Avg_Mean_Temp\" ~ \"Average Mean Temperature\",\n                           metric == \"Avg_Max_Temp\" ~ \"Average of Max Temperature\",\n                           metric == \"Avg_Min_Temp\" ~ \"Average of Minimum Temperature\",\n                           metric == \"Max_Temp\" ~ \"Maximum Temperature\",\n                           metric == \"Min_Temp\" ~ \"Minimum Temperature\",\n                           TRUE ~ metric)\n  \n  test_label = case_when(t_type == \"parametric\" ~ \"Mean (Parametric)\",\n                         t_type == \"nonparametric\" ~ \"Median (Non-Parametric)\",\n                         t_type == \"robust\" ~ \"Mean (Robust t-test)\",\n                         t_type == \"bayes\" ~ \"Mean (Bayesian)\",)\n  \n  temp_monthly_anova <- temp_monthly %>%\n    filter(Station %in% selected_station) %>%\n    mutate(Station = fct_reorder(Station, !!sym(metric), .desc = TRUE))\n  \n  if(nooutliers == T){\n  temp_monthly_anova <- temp_monthly_anova %>%\n      treat_outliers() \n  }\n  \n  temp_monthly_anova %>%\n    ggbetweenstats(x = Station,\n                   y = !!sym(metric),\n                   plot.type = p_type,\n                   type = t_type,\n                   pairwise.comparisons = T,\n                   pairwise.display = pair_disp,\n                   mean.ci = T, \n                   p.adjust.method = \"fdr\",\n                   conf.level = conf,\n                   xlab = \"Station\", ylab = metric_label,)\n}\n```\n:::\n\n\n::: panel-tabset\n#### Test 1\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMonthly_Top3_Temp_Station(metric = \"Avg_Mean_Temp\", \n                          selected_station = top3,\n                          p_type = \"boxviolin\",\n                          t_type = \"nonparametric\",\n                          pair_disp = \"non-significant\",\n                          pair.comp = T,\n                          conf = 0.95,\n                          nooutliers = T)\n```\n\n::: {.cell-output-display}\n![](CDA_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n#### Test 2\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMonthly_Top3_Temp_Station(metric = \"Max_Temp\", \n                          selected_station = top3,\n                          p_type = \"box\",\n                          t_type = \"nonparametric\",\n                          pair_disp = \"non-significant\",\n                          pair.comp = T,\n                          conf = 0.95,\n                          nooutliers = T)\n```\n\n::: {.cell-output-display}\n![](CDA_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\n#### Test 3\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMonthly_Top3_Temp_Station(metric = \"Avg_Min_Temp\", \n                          selected_station = top3,\n                          p_type = \"violin\",\n                          t_type = \"nonparametric\",\n                          pair_disp = \"non-significant\",\n                          pair.comp = T,\n                          conf = 0.99,\n                          nooutliers = T)\n```\n\n::: {.cell-output-display}\n![](CDA_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n:::\n\n## 6.2. Create Function - Monthly temperature by Region\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMonthly_Temp_Region <- function(metric = \"Avg_Mean_Temp\", \n                                p_type = \"boxviolin\",\n                                t_type = \"nonparametric\",\n                                pair_disp = \"non-significant\",\n                                pair.comp = T,\n                                conf = 0.95,\n                                nooutliers = T){\n  \n  metric_label = case_when(metric == \"Avg_Mean_Temp\" ~ \"Average Mean Temperature\",\n                           metric == \"Avg_Max_Temp\" ~ \"Average of Max Temperature\",\n                           metric == \"Avg_Min_Temp\" ~ \"Average of Minimum Temperature\",\n                           metric == \"Max_Temp\" ~ \"Maximum Temperature\",\n                           metric == \"Min_Temp\" ~ \"Minimum Temperature\",\n                           TRUE ~ metric)\n  \n  test_label = case_when(t_type == \"parametric\" ~ \"Mean (Parametric)\",\n                         t_type == \"nonparametric\" ~ \"Median (Non-Parametric)\",\n                         t_type == \"robust\" ~ \"Mean (Robust t-test)\",\n                         t_type == \"bayes\" ~ \"Mean (Bayesian)\",)\n  \n  if(nooutliers == T){\n  temp_monthly <- temp_monthly %>%\n      treat_outliers() \n  }\n  \n  temp_monthly %>%\n    ggbetweenstats(x = Region,\n                   y = !!sym(metric),\n                   plot.type = p_type,\n                   type = t_type,\n                   pairwise.comparisons = T,\n                   pairwise.display = pair_disp,\n                   mean.ci = T, \n                   p.adjust.method = \"fdr\",\n                   conf.level = conf,\n                   xlab = \"Region\", ylab = metric_label,)\n}\n```\n:::\n\n\n::: panel-tabset\n#### Test 1\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMonthly_Temp_Region(metric = \"Avg_Mean_Temp\", \n                    p_type = \"boxviolin\",\n                    t_type = \"nonparametric\",\n                    pair_disp = \"non-significant\",\n                    pair.comp = T,\n                    conf = 0.95,\n                   nooutliers = T)\n```\n\n::: {.cell-output-display}\n![](CDA_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n\n#### Test 2\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMonthly_Temp_Region(metric = \"Max_Temp\",\n                    p_type = \"box\",\n                    t_type = \"nonparametric\",\n                    pair_disp = \"non-significant\",\n                    pair.comp = T,\n                    conf = 0.95,\n                    nooutliers = T)\n```\n\n::: {.cell-output-display}\n![](CDA_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n\n#### Test 3\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMonthly_Temp_Region(metric = \"Avg_Min_Temp\", \n                    p_type = \"violin\",\n                    t_type = \"nonparametric\",\n                    pair_disp = \"non-significant\",\n                    pair.comp = T,\n                    conf = 0.99,\n                    nooutliers = T)\n```\n\n::: {.cell-output-display}\n![](CDA_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n:::\n\n# 7. Compare Annual Rainfall\n\n## 7.1. Create Function - Annual Rainfall by Station\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrf_annual_sorted <-  rf_annual %>%\n  arrange(desc(Avg_Total_Rf))\n\ntop3 <- rf_annual_sorted$Station[1:3]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nAnnual_Top3_Rf_Station <- function(metric = \"Avg_Total_Rf\", \n                                selected_station,\n                                p_type = \"boxviolin\",\n                                t_type = \"nonparametric\",\n                                pair_disp = \"non-significant\",\n                                pair.comp = T,\n                                conf = 0.95,\n                                nooutliers = T){\n  \n  metric_label = case_when(metric == \"Avg_Total_Rf\" ~ \"Average Total Rainfall\",\n                           metric == \"Avg_Total_Rf30\" ~ \"Average of Total Rainfall in 30 min\",\n                           metric == \"Avg_Total_Rf60\" ~ \"Average of Total Rainfall in 60 min\",\n                           metric == \"Avg_Total_Rf120\" ~ \"Average of Total Rainfall in 120 min\",\n                           metric == \"Max_Total_Rf\" ~ \"Maximum Total Rainfall\",\n                           metric == \"Min_Total_Rf\" ~ \"Minimum Total Rainfall\",\n                           TRUE ~ metric)\n\n  test_label = case_when(t_type == \"parametric\" ~ \"Mean (Parametric)\",\n                         t_type == \"nonparametric\" ~ \"Median (Non-Parametric)\",\n                         t_type == \"robust\" ~ \"Mean (Robust t-test)\",\n                         t_type == \"bayes\" ~ \"Mean (Bayesian)\",)\n  \n  rf_annual_anova <- rf_annual %>%\n    filter(Station %in% selected_station) %>%\n    mutate(Station = fct_reorder(Station, !!sym(metric), .desc = TRUE))\n  \n  if(nooutliers == T){\n  rf_annual_anova <- rf_annual_anova %>%\n      treat_outliers() \n  }\n  \n  rf_annual_anova %>%\n    ggbetweenstats(x = Station,\n                   y = !!sym(metric),\n                   plot.type = p_type,\n                   type = t_type,\n                   pairwise.comparisons = T,\n                   pairwise.display = pair_disp,\n                   mean.ci = T, \n                   p.adjust.method = \"fdr\",\n                   conf.level = conf,\n                   xlab = \"Station\", ylab = metric_label,)\n}\n```\n:::\n\n\n::: panel-tabset\n#### Test 1\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAnnual_Top3_Rf_Station(metric = \"Avg_Total_Rf\", \n                         selected_station = top3,\n                         p_type = \"boxviolin\",\n                         t_type = \"nonparametric\",\n                         pair_disp = \"non-significant\",\n                         pair.comp = T,\n                         conf = 0.95,\n                         nooutliers = T)\n```\n\n::: {.cell-output-display}\n![](CDA_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n:::\n\n\n#### Test 2\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAnnual_Top3_Rf_Station(metric = \"Avg_Total_Rf60\", \n                         selected_station = top3,\n                         p_type = \"box\",\n                         t_type = \"nonparametric\",\n                         pair_disp = \"non-significant\",\n                         pair.comp = T,\n                         conf = 0.95,\n                         nooutliers = T)\n```\n\n::: {.cell-output-display}\n![](CDA_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n:::\n\n\n#### Test 3\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAnnual_Top3_Rf_Station(metric = \"Max_Total_Rf\", \n                         selected_station = top3,\n                         p_type = \"violin\",\n                         t_type = \"nonparametric\",\n                         pair_disp = \"non-significant\",\n                         pair.comp = T,\n                         conf = 0.99,\n                         nooutliers = T)\n```\n\n::: {.cell-output-display}\n![](CDA_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n:::\n\n:::\n\n## 7.2. Create Function - Annual Rainfall by Region\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAnnual_Rf_Region <- function(metric = \"Avg_Total_Rf\", \n                               p_type = \"boxviolin\",\n                               t_type = \"nonparametric\",\n                               pair_disp = \"non-significant\",\n                               pair.comp = T,\n                               conf = 0.95,\n                               nooutliers = T){\n  \n  metric_label = case_when(metric == \"Avg_Total_Rf\" ~ \"Average Total Rainfall\",\n                           metric == \"Avg_Total_Rf30\" ~ \"Average of Total Rainfall in 30 min\",\n                           metric == \"Avg_Total_Rf60\" ~ \"Average of Total Rainfall in 60 min\",\n                           metric == \"Avg_Total_Rf120\" ~ \"Average of Total Rainfall in 120 min\",\n                           metric == \"Max_Total_Rf\" ~ \"Maximum Total Rainfall\",\n                           metric == \"Min_Total_Rf\" ~ \"Minimum Total Rainfall\",\n                           TRUE ~ metric)\n  \n  test_label = case_when(t_type == \"parametric\" ~ \"Mean (Parametric)\",\n                         t_type == \"nonparametric\" ~ \"Median (Non-Parametric)\",\n                         t_type == \"robust\" ~ \"Mean (Robust t-test)\",\n                         t_type == \"bayes\" ~ \"Mean (Bayesian)\",)\n  \n  if(nooutliers == T){\n  rf_annual <- rf_annual %>%\n      treat_outliers() \n  }\n  \n  rf_annual %>%\n    ggbetweenstats(x = Region,\n                   y = !!sym(metric),\n                   plot.type = p_type,\n                   type = t_type,\n                   pairwise.comparisons = T,\n                   pairwise.display = pair_disp,\n                   mean.ci = T, \n                   p.adjust.method = \"fdr\",\n                   conf.level = conf,\n                   xlab = \"Region\", ylab = metric_label,)\n}\n```\n:::\n\n\n::: panel-tabset\n#### Test 1\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAnnual_Rf_Region(metric = \"Avg_Total_Rf\", \n                   p_type = \"violin\",\n                   t_type = \"nonparametric\",\n                   pair_disp = \"non-significant\",\n                   pair.comp = T,\n                   conf = 0.99,\n                   nooutliers = T)\n```\n\n::: {.cell-output-display}\n![](CDA_files/figure-html/unnamed-chunk-34-1.png){width=672}\n:::\n:::\n\n\n#### Test 2\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAnnual_Rf_Region(metric = \"Avg_Total_Rf60\",\n                   p_type = \"box\",\n                   t_type = \"nonparametric\",\n                   pair_disp = \"non-significant\",\n                   pair.comp = T,\n                   conf = 0.95,\n                   nooutliers = T)\n```\n\n::: {.cell-output-display}\n![](CDA_files/figure-html/unnamed-chunk-35-1.png){width=672}\n:::\n:::\n\n\n#### Test 3\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAnnual_Rf_Region(metric = \"Max_Total_Rf\", \n                   p_type = \"violin\",\n                   t_type = \"nonparametric\",\n                   pair_disp = \"non-significant\",\n                   pair.comp = T,\n                   conf = 0.99,\n                   nooutliers = T)\n```\n\n::: {.cell-output-display}\n![](CDA_files/figure-html/unnamed-chunk-36-1.png){width=672}\n:::\n:::\n\n:::\n\n# 8. Compare Monthly Rainfall\n\n## 8.1. Create Function - Monthly Rainfall by Station\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrf_monthly_sorted <-  rf_monthly %>%\n  arrange(desc(Avg_Total_Rf))\n\ntop3 <- rf_monthly_sorted$Station[1:3]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nMonthly_Rf_Station <- function(metric = \"Avg_Total_Rf\", \n                                selected_station,\n                                p_type = \"boxviolin\",\n                                t_type = \"nonparametric\",\n                                pair_disp = \"non-significant\",\n                                pair.comp = T,\n                                conf = 0.95,\n                                nooutliers = T){\n  \n  metric_label = case_when(metric == \"Avg_Total_Rf\" ~ \"Average Total Rainfall\",\n                           metric == \"Avg_Total_Rf30\" ~ \"Average of Total Rainfall in 30 min\",\n                           metric == \"Avg_Total_Rf60\" ~ \"Average of Total Rainfall in 60 min\",\n                           metric == \"Avg_Total_Rf120\" ~ \"Average of Total Rainfall in 120 min\",\n                           metric == \"Max_Total_Rf\" ~ \"Maximum Total Rainfall\",\n                           metric == \"Min_Total_Rf\" ~ \"Minimum Total Rainfall\",\n                           TRUE ~ metric)\n\n  test_label = case_when(t_type == \"parametric\" ~ \"Mean (Parametric)\",\n                         t_type == \"nonparametric\" ~ \"Median (Non-Parametric)\",\n                         t_type == \"robust\" ~ \"Mean (Robust t-test)\",\n                         t_type == \"bayes\" ~ \"Mean (Bayesian)\",)\n  \n  rf_monthly_anova <- rf_monthly %>%\n    filter(Station %in% selected_station) %>%\n    mutate(Station = fct_reorder(Station, !!sym(metric), .desc = TRUE))\n  \n  if(nooutliers == T){\n  rf_monthly_anova <- rf_monthly_anova %>%\n      treat_outliers() \n  }\n  \n  rf_monthly_anova %>%\n    ggbetweenstats(x = Station,\n                   y = !!sym(metric),\n                   plot.type = p_type,\n                   type = t_type,\n                   pairwise.comparisons = T,\n                   pairwise.display = pair_disp,\n                   mean.ci = T, \n                   p.adjust.method = \"fdr\",\n                   conf.level = conf,\n                   xlab = \"Station\", ylab = metric_label,)\n}\n```\n:::\n\n\n::: panel-tabset\n#### Test 1\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMonthly_Rf_Station(metric = \"Avg_Total_Rf\", \n                         selected_station = top3,\n                         p_type = \"boxviolin\",\n                         t_type = \"nonparametric\",\n                         pair_disp = \"non-significant\",\n                         pair.comp = T,\n                         conf = 0.95,\n                         nooutliers = T)\n```\n\n::: {.cell-output-display}\n![](CDA_files/figure-html/unnamed-chunk-39-1.png){width=672}\n:::\n:::\n\n\n#### Test 2\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMonthly_Rf_Station(metric = \"Avg_Total_Rf60\", \n                         selected_station = top3,\n                         p_type = \"box\",\n                         t_type = \"nonparametric\",\n                         pair_disp = \"non-significant\",\n                         pair.comp = T,\n                         conf = 0.95,\n                         nooutliers = T)\n```\n\n::: {.cell-output-display}\n![](CDA_files/figure-html/unnamed-chunk-40-1.png){width=672}\n:::\n:::\n\n\n#### Test 3\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMonthly_Rf_Station(metric = \"Max_Total_Rf\", \n                         selected_station = top3,\n                         p_type = \"violin\",\n                         t_type = \"nonparametric\",\n                         pair_disp = \"non-significant\",\n                         pair.comp = T,\n                         conf = 0.99,\n                         nooutliers = T)\n```\n\n::: {.cell-output-display}\n![](CDA_files/figure-html/unnamed-chunk-41-1.png){width=672}\n:::\n:::\n\n:::\n\n## 8.2. Create Function - Monthly Rainfall by Region\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMonthly_Rf_Region <- function(metric = \"Avg_Total_Rf\", \n                               p_type = \"boxviolin\",\n                               t_type = \"nonparametric\",\n                               pair_disp = \"non-significant\",\n                               pair.comp = T,\n                               conf = 0.95,\n                               nooutliers = T){\n  \n  metric_label = case_when(metric == \"Avg_Total_Rf\" ~ \"Average Total Rainfall\",\n                           metric == \"Avg_Total_Rf30\" ~ \"Average of Total Rainfall in 30 min\",\n                           metric == \"Avg_Total_Rf60\" ~ \"Average of Total Rainfall in 60 min\",\n                           metric == \"Avg_Total_Rf120\" ~ \"Average of Total Rainfall in 120 min\",\n                           metric == \"Max_Total_Rf\" ~ \"Maximum Total Rainfall\",\n                           metric == \"Min_Total_Rf\" ~ \"Minimum Total Rainfall\",\n                           TRUE ~ metric)\n  \n  test_label = case_when(t_type == \"parametric\" ~ \"Mean (Parametric)\",\n                         t_type == \"nonparametric\" ~ \"Median (Non-Parametric)\",\n                         t_type == \"robust\" ~ \"Mean (Robust t-test)\",\n                         t_type == \"bayes\" ~ \"Mean (Bayesian)\",)\n  \n  if(nooutliers == T){\n  rf_monthly <- rf_monthly %>%\n      treat_outliers() \n  }\n  \n  rf_monthly %>%\n    ggbetweenstats(x = Region,\n                   y = !!sym(metric),\n                   plot.type = p_type,\n                   type = t_type,\n                   pairwise.comparisons = T,\n                   pairwise.display = pair_disp,\n                   mean.ci = T, \n                   p.adjust.method = \"fdr\",\n                   conf.level = conf,\n                   xlab = \"Region\", ylab = metric_label,)\n}\n```\n:::\n\n\n::: panel-tabset\n#### Test 1\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMonthly_Rf_Region(metric = \"Avg_Total_Rf\", \n                   p_type = \"violin\",\n                   t_type = \"nonparametric\",\n                   pair_disp = \"non-significant\",\n                   pair.comp = T,\n                   conf = 0.99,\n                   nooutliers = T)\n```\n\n::: {.cell-output-display}\n![](CDA_files/figure-html/unnamed-chunk-43-1.png){width=672}\n:::\n:::\n\n\n#### Test 2\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMonthly_Rf_Region(metric = \"Avg_Total_Rf60\",\n                   p_type = \"box\",\n                   t_type = \"nonparametric\",\n                   pair_disp = \"non-significant\",\n                   pair.comp = T,\n                   conf = 0.95,\n                   nooutliers = T)\n```\n\n::: {.cell-output-display}\n![](CDA_files/figure-html/unnamed-chunk-44-1.png){width=672}\n:::\n:::\n\n\n#### Test 3\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMonthly_Rf_Region(metric = \"Max_Total_Rf\", \n                   p_type = \"violin\",\n                   t_type = \"nonparametric\",\n                   pair_disp = \"non-significant\",\n                   pair.comp = T,\n                   conf = 0.99,\n                   nooutliers = T)\n```\n\n::: {.cell-output-display}\n![](CDA_files/figure-html/unnamed-chunk-45-1.png){width=672}\n:::\n:::\n\n:::\n\n# 9. Mock-up of UI Design\n\nAfter submitting the individual assignments, the analysis will be transferred to the group's Shiny app. Based on the identified parameters available for user input, we envision that the Shiny app will look like the following mock-up:\n\n![](images/Slide2-03.JPG)\n\n![](images/Slide3-02.JPG)\n",
    "supporting": [
      "CDA_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}